{% extends 'main.html' %}
{% load static %}
{% load flow_state %}
{% load i18n %}

{% block page_title %}
  {% trans "Links to your data" %}
{% endblock %}

{% block inner_content %}
  <main id="content" role="main" tabindex="-1">
    {% if file_to_delete_id %}
      <div
          class="confirm-box"
          role="group"
          aria-labelledby="confirm-heading"
          tabindex="-1">
        <h1 id="confirm-heading" class="heading-medium">
          {% blocktrans %}
            Are you sure you want to delete ‘{{ file_to_delete_title }}’?
          {% endblocktrans %}
        </h1>
        <div class="confirm-box-actions">
          <a
              class="button"
              href="{% url 'edit_dataset_deletefile' dataset.name file_to_delete_id %}">
            {% trans 'Yes, delete this link' %}</a>
          <a
              class="secondary-button"
              href="{% url 'edit_dataset_files' dataset.name %}">
            {% trans 'Cancel' %}
          </a>
        </div>
      </div>
    {% endif %}

    {% if messages %}
      <div class="confirm-box">
        {% for message in messages %}
          <h1 class="heading-medium"> {{ message|safe }}</h1>
        {% endfor %}
      </div>
    {% endif %}

    <h1 class="heading-large">
      {% trans "Links to your data" %}
    </h1>

    <table>
      {% blocktrans %}
        <thead>
          <tr>
            <th>Link</th>
            <th>Valid</th>
            <th><span class="visuallyhidden">Actions</span></th>
          </tr>
        </thead>
      {% endblocktrans %}
      <tbody>
        {% for file in files %}
          <tr id="file_{{ forloop.counter }}">
            <td><a href="{{ file.url }}">{{ file.title }}</a></td>
            <td>{% if not file.is_broken %}✔{% else %}&#x2716;{% endif%}</td>
            <td class="actions">
              <a href="{% url addfile_viewname dataset.name file.id %}">{% trans "Edit" %}</a>
              <a href="{% url 'edit_dataset_confirmdeletefile' dataset.name file.id %}">{% trans "Delete" %}</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <p>
      <a href="{% url addfile_viewname dataset.name %}">
        {% if files|length == 0 %}
          {% trans "Add a link" %}
        {% else %}
          {% trans "Add another link" %}
        {% endif %}
      </a>
    </p>

    <p>
      <a
          {% if request|is_checking %}
          href="{% url 'publish_dataset' dataset.name %}"
          {% elif request|is_editing %}
          href="{% url 'edit_full_dataset' dataset.name %}"
          {% else %}
          href="{% url 'edit_dataset_adddoc' dataset.name %}"
          {% endif %}
          class="button">
        {% trans "Save and continue" %}
      </a>
    </p>

  </main>
{% endblock %}
