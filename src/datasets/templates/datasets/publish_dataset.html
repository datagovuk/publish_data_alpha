{% extends 'main_with_navbar.html' %}
{% load static %}
{% load flow_state %}

{% block page_title %}
  Check your dataset
{% endblock %}

{% block inner_content %}

  {% include 'datasets/includes/error_box.html' %}

  <h1 class="heading-large">
    {% if request|is_checking %}
      Check your dataset
    {% else %}
      Edit ‘{{ dataset.title }}’
    {% endif %}
  </h1>

  <table class="check-your-answers">
    <tbody>
      <tr>
        <td class="dataset-item">
          Name<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset' dataset.name %}">
            Change <span class="visuallyhidden">dataset name</span>
          </a>
        </td>
        <td>
          {{ dataset.title }}
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          Summary<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset' dataset.name %}">
            Change <span class="visuallyhidden">summary</span>
          </a>
        </td>
        <td>
          {{ dataset.summary|truncatechars:65 }}
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          Additional information<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset' dataset.name %}">
            Change <span class="visuallyhidden">description</span>
          </a>
        </td>
        <td>
          {{ dataset.description|truncatechars:250 }}
        </td>
      </tr>
      {% if not single_organisation %}
        <tr>
          <td class="dataset-item">
            Organisation<br/>
            <a class="font-xsmall" href="{% url 'edit_dataset_organisation' dataset.name %}">
              Change <span class="visuallyhidden">description</span>
            </a>
          </td>
          <td>
            {{ organisation.title }}
          </td>
        </tr>
      {% endif %}
      <tr>
        <td class="dataset-item">
          Links<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_files' dataset.name %}">
            Change <span class="visuallyhidden">datafiles</span>
          </a>
        </td>
        <td>
          <ul>
          {% for link in datafiles %}
            <li>
              {{ link.title }} ({{ link.url }})
            </li>
          {% endfor %}
          </ul>
        </td>
      </tr>
      <tr class="dataset-item">
        <td>
          Documentation<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_documents' dataset.name %}">
            Change <span class="visuallyhidden">documents</span>
          </a>
        </td>
        <td>
          <ul>
          {% for link in docfiles %}
            <li>
              {{ link.title }}&nbsp;{{ link.url }}
            </li>
          {% endfor %}
          </ul>
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          Location<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_location' dataset.name %}">
            Change <span class="visuallyhidden">location</span>
          </a>
        </td>
        <td>
          <ul>
            <li>{{ dataset.location1 }}</li>
            <li>{{ dataset.location2 }}</li>
            <li>{{ dataset.location3 }}</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          Licence<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_licence' dataset.name %}">
            Change <span class="visuallyhidden">licence</span>
          </a>
        </td>
        <td>
          {% if dataset.licence == "uk-ogl" %}
            Open Government Licence
          {% else %}
            {{ dataset.licence_other }}
          {% endif %}
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          Frequency Update<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_frequency' dataset.name %}">
            Change <span class="visuallyhidden">frequency update</span>
          </a>
        </td>
        <td>
          {{ dataset.frequency|title }}
        </td>
      </tr>
      {% if dataset.notifications %}
        <tr>
          <td class="dataset-item">
            Notifications<br/>
            <a class="font-xsmall" href="{% url 'edit_dataset_notifications' dataset.name %}">
              Change <span class="visuallyhidden">notifications</span>
            </a>
          </td>
          <td>
            {{ dataset.notifications|title }}
          </td>
        </tr>
      {% endif %}
    </tbody>
  </table>

  <form
      action="{% url 'publish_dataset' dataset.name %}"
      method="POST">
    {% csrf_token %}
    <div class="form-group">
      {% if dataset.published %}
        <input type="submit" class="button" value="Done"/>
      {% else %}
        <input type="submit" class="button" value="Publish"/>
        <a
            href="{% url 'manage_data'%}"
            class="secondary-button">
          Save for later
        </a>
      {% endif %}
    </div>

  </form>

{% endblock %}
