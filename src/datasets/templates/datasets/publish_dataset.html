{% extends 'main_with_navbar.html' %}
{% load static %}
{% load flow_state %}
{% load i18n %}

{% block page_title %}
  {% trans "Check your dataset" %}
{% endblock %}

{% block inner_content %}

  {% include 'datasets/includes/error_box.html' %}

  <h1 class="heading-large">
    {% if request|is_checking %}
      {% trans "Check your dataset" %}
    {% else %}
      {% trans "Edit" %} ‘{{ dataset.title }}’
    {% endif %}
  </h1>

  <table class="check-your-answers">
    <tbody>
      <tr>
        <td class="dataset-item">
          {% trans "Name" %}<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset' dataset.name %}">
            {% trans "Change <span class='visuallyhidden'>dataset name</span>" %}
          </a>
        </td>
        <td>
          {{ dataset.title }}
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          {% trans "Summary" %}<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset' dataset.name %}">
            {% trans "Change <span class='visuallyhidden'>summary</span>" %}
          </a>
        </td>
        <td>
          {{ dataset.summary|truncatechars:65 }}
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          {% trans "Additional information" %}<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset' dataset.name %}">
            {% trans "Change <span class='visuallyhidden'>description</span>" %}
          </a>
        </td>
        <td>
          {{ dataset.description|truncatechars:250 }}
        </td>
      </tr>
        <tr>
          <td class="dataset-item">
            {% trans "Organisation" %}<br/>
            {% if not single_organisation %}
              <a class="font-xsmall" href="{% url 'edit_dataset_organisation' dataset.name %}">
                {% trans "Change <span class='visuallyhidden'>description</span>" %}
              </a>
            {% endif %}
          </td>
          <td>
            {{ organisation.title }}
          </td>
        </tr>
      <tr>
        <td class="dataset-item">
          {% trans "Links" %}<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_files' dataset.name %}">
            {% trans "Change <span class='visuallyhidden'>datafiles</span>" %}
          </a>
        </td>
        <td>
          <ul>
          {% for link in datafiles %}
            <li>
              {{ link.title }} ({{ link.url }})
            </li>
          {% endfor %}
          </ul>
        </td>
      </tr>
      <tr class="dataset-item">
        <td>
          {% trans "Documentation" %}<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_documents' dataset.name %}">
            {% trans "Change <span class='visuallyhidden'>documents</span>" %}
          </a>
        </td>
        <td>
          <ul>
          {% for link in docfiles %}
            <li>
              {{ link.title }}&nbsp;{{ link.url }}
            </li>
          {% endfor %}
          </ul>
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          {% trans "Location" %}<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_location' dataset.name %}">
            {% trans "Change <span class='visuallyhidden'>location</span>" %}
          </a>
        </td>
        <td>
          <ul>
            <li>{{ dataset.location1 }}</li>
            <li>{{ dataset.location2 }}</li>
            <li>{{ dataset.location3 }}</li>
          </ul>
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          {% trans "Licence" %}<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_licence' dataset.name %}">
            {% trans "Change <span class='visuallyhidden'>licence</span>" %}
          </a>
        </td>
        <td>
          {% if dataset.licence == "uk-ogl" %}
            {% trans "Open Government Licence" %}
          {% else %}
            {{ dataset.licence_other }}
          {% endif %}
        </td>
      </tr>
      <tr>
        <td class="dataset-item">
          {% trans "Frequency Update" %}<br/>
          <a class="font-xsmall" href="{% url 'edit_dataset_frequency' dataset.name %}">
            {% trans "Change <span class='visuallyhidden'>frequency update</span>" %}
          </a>
        </td>
        <td>
          {% if dataset.frequency == 'daily' %}
            {% trans "Daily" %}
          {% elif dataset.frequency == 'weekly' %}
            {% trans "Weekly" %}
          {% elif dataset.frequency == 'monthly' %}
            {% trans "Monthly" %}
          {% elif dataset.frequency == 'quarterly' %}
            {% trans "Quarterly" %}
          {% elif dataset.frequency == 'annually' %}
            {% trans "Annually (January to December)" %}
          {% elif dataset.frequency == 'financial-year' %}
            {% trans "Annually (April to March)" %}
          {% else %}
            {{ dataset.frequency|title }}
          {% endif %}
        </td>
      </tr>
      {% if dataset.notifications %}
        <tr>
          <td class="dataset-item">
            {% trans "Notifications" %}<br/>
            <a class="font-xsmall" href="{% url 'edit_dataset_notifications' dataset.name %}">
              {% trans "Change <span class='visuallyhidden'>notifications</span>" %}
            </a>
          </td>
          <td>
            {{ dataset.notifications|title }}
          </td>
        </tr>
      {% endif %}
    </tbody>
  </table>

  <form
      action="{% url 'publish_dataset' dataset.name %}"
      method="POST">
    {% csrf_token %}
    <div class="form-group">
      {% if dataset.published %}
        <p>
          <input type="submit" class="button" value="{% trans "Done" %}"/>
        </p>
      {% else %}
        <p>
          <p>
            <input type="submit" class="button" value="{% trans "Publish" %}"/>
          </p>
          <p>
            <a
                href="{% url 'manage_data'%}"
                class="secondary-button">
              {% trans "Save for later" %}
            </a>
          </p>
        </p>
      {% endif %}
    </div>

  </form>

{% endblock %}
